services:
  domainac:
    build:
      context: .
      dockerfile: Dockerfile
      pull: true
      no_cache: true
    image: domainac:latest
    pull_policy: build
    container_name: domainac
    working_dir: /opt/domainac
    environment:
      - PORT=18080
    ports:
      - "18080:18080"
    restart: unless-stopped

  domainac-mcp:
    build:
      context: .
      dockerfile: Dockerfile
      pull: true
      no_cache: true
    image: domainac:latest
    pull_policy: build
    container_name: domainac-mcp
    working_dir: /opt/domainac
    command: ["python", "/opt/domainac/app/run_mcp_server.py"]
    environment:
      - MCP_TRANSPORT=streamable-http
      - MCP_HOST=0.0.0.0
      - MCP_PORT=18081
      - MCP_STREAMABLE_HTTP_PATH=/mcp
    ports:
      - "18081:18081"
    restart: unless-stopped
